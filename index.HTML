<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Drainage Complaint Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      #success-message,
      #status-display {
        transition: opacity 0.5s ease-in-out;
      }
    </style>
  </head>
  <body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div
      class="w-full max-w-lg mx-auto bg-white rounded-lg border border-gray-300 shadow-md p-6 md:p-8 m-4"
    >
      <div class="text-center md:text-left mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">
          Drainage Complaint Portal
        </h1>
        <p class="text-gray-500 mt-1">
          Raise and track your complaints regarding drainage system issues
        </p>
      </div>

      <hr class="mb-6" />

      <div id="tracker-container" class="mb-6">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">
          Track Your Complaint
        </h2>
        <div
          class="flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0"
        >
          <input
            type="text"
            id="ref-input"
            class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 flex-grow"
            placeholder="Enter your reference number (e.g., DR123456)"
          />
          <button
            id="track-btn"
            class="w-full sm:w-auto bg-gray-600 text-white font-semibold py-2.5 px-6 rounded-md shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150 ease-in-out"
          >
            Track
          </button>
        </div>
      </div>

      <div
        id="status-display"
        class="hidden mb-6 p-4 border rounded-md bg-gray-50"
      ></div>
      <form id="complaint-form">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">
          Submit Your Complaint
        </h2>

        <div class="space-y-4">
          <div>
            <label
              for="full-name"
              class="block text-sm font-medium text-gray-600 mb-1"
              >Full Name</label
            >
            <input
              type="text"
              id="full-name"
              name="full-name"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="Full Name"
            />
          </div>
          <div>
            <label
              for="email"
              class="block text-sm font-medium text-gray-600 mb-1"
              >Email Address</label
            >
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="you@example.com"
            />
          </div>
          <div>
            <label
              for="address-area"
              class="block text-sm font-medium text-gray-600 mb-1"
              >Your Area</label
            >
            <select
              id="address-area"
              name="address-area"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            >
              <option value="" disabled selected>Select your area</option>
              <option value="north-district">North District</option>
              <option value="south-district">South District</option>
              <option value="east-district">East District</option>
              <option value="west-district">West District</option>
              <option value="central-district">Central District</option>
            </select>
          </div>
          <div>
            <label
              for="description"
              class="block text-sm font-medium text-gray-600 mb-1"
              >Description of the Problem</label
            >
            <textarea
              id="description"
              name="description"
              rows="4"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="Describe the issue"
            ></textarea>
          </div>
        </div>
        <div class="mt-6">
          <button
            type="submit"
            class="w-full bg-blue-600 text-white font-semibold py-2.5 px-4 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out"
          >
            Submit Complaint
          </button>
        </div>
      </form>
      <div
        id="success-message"
        class="hidden opacity-0 mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-md"
      >
        <p class="font-bold">Success!</p>
        <p>
          Your complaint has been submitted. Your reference number is
          <span id="ref-number" class="font-mono font-bold"></span>.
        </p>
      </div>
      <div class="text-center text-gray-400 text-xs mt-8 pt-6 border-t">
        &copy; 2024 Drainage Department. All rights reserved.
      </div>
    </div>

    <script>
      const complaintForm = document.getElementById("complaint-form");
      const successMessage = document.getElementById("success-message");
      const refNumberSpan = document.getElementById("ref-number");

      const trackBtn = document.getElementById("track-btn");
      const refInput = document.getElementById("ref-input");
      const statusDisplay = document.getElementById("status-display");

      const complaints = {
        DR543210: {
          name: "Jane Doe",
          description:
            "Main sewer line in front of the community hall is completely blocked. Overflowing onto the street.",
          area: "North District",
          status: "In Progress", // Can be 'Submitted', 'In Progress', 'Resolved'
          submittedAt: "2025-09-17T10:00:00Z",
          notes: "Work crew assigned. Expected to start work by EOD.",
        },
        DR987654: {
          name: "John Smith",
          description:
            "Gutter on Oak Street is broken and causing water to pool.",
          area: "West District",
          status: "Resolved",
          submittedAt: "2025-09-15T14:30:00Z",
          notes: "Gutter section replaced and blockage cleared on 2025-09-16.",
        },
      };

      trackBtn.addEventListener("click", function () {
        const refId = refInput.value.trim().toUpperCase();
        if (!refId) {
          alert("Please enter a reference number.");
          return;
        }
        const complaint = complaints[refId];

        statusDisplay.classList.remove("hidden");
        statusDisplay.style.opacity = "0";

        if (complaint) {
          const statusConfig = {
            Submitted: { color: "blue", progress: "33%" },
            "In Progress": { color: "yellow", progress: "66%" },
            Resolved: { color: "green", progress: "100%" },
          };
          const currentStatus = statusConfig[complaint.status] || {
            color: "gray",
            progress: "0%",
          };

          statusDisplay.innerHTML = `
                <h3 class="text-lg font-bold text-gray-800 mb-3">Status for ${refId}</h3>
                <div class="space-y-3">
                    <div>
                        <span class="font-semibold text-gray-700">Status:</span>
                        <span class="font-bold text-${
                          currentStatus.color
                        }-700 bg-${
            currentStatus.color
          }-100 py-1 px-3 rounded-full text-sm">${complaint.status}</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div class="bg-${
                          currentStatus.color
                        }-500 h-2.5 rounded-full transition-all duration-500" style="width: ${
            currentStatus.progress
          }"></div>
                    </div>
                    <div>
                        <span class="font-semibold text-gray-700">Problem:</span>
                        <p class="text-gray-600 italic">"${
                          complaint.description
                        }"</p>
                    </div>
                    <div>
                        <span class="font-semibold text-gray-700">Submitted On:</span>
                        <span class="text-gray-600">${new Date(
                          complaint.submittedAt
                        ).toLocaleString()}</span>
                    </div>
                    <div>
                        <span class="font-semibold text-gray-700">Latest Update:</span>
                        <p class="text-gray-600">${complaint.notes}</p>
                    </div>
                </div>
            `;
        } else {
          statusDisplay.innerHTML = `
                <p class="font-bold text-red-700">Complaint Not Found</p>
                <p class="text-red-600">Please verify the reference number and try again. Note: Reference numbers are case-sensitive (e.g., DR123456).</p>
            `;
        }

        setTimeout(() => {
          statusDisplay.style.opacity = "1";
        }, 10);
      });

      complaintForm.addEventListener("submit", function (event) {
        event.preventDefault();
        const referenceNumber = "DR" + Date.now().toString().slice(-6);
        refNumberSpan.textContent = referenceNumber;

        const formData = {
          name: document.getElementById("full-name").value,
          description: document.getElementById("description").value,
          area: document.getElementById("address-area").value,
          status: "Submitted",
          submittedAt: new Date().toISOString(),
          notes:
            "Your complaint has been received by the system and is awaiting assignment to a technician.",
        };
        complaints[referenceNumber] = formData;

        complaintForm.style.display = "none";
        successMessage.classList.remove("hidden");
        setTimeout(() => {
          successMessage.style.opacity = "1";
        }, 10);

        console.log("Form Submitted!");
        console.log("Reference Number:", referenceNumber);
        console.log("Name:", document.getElementById("full-name").value);
        console.log("Email:", document.getElementById("email").value);
        console.log("Area:", document.getElementById("address-area").value);
        console.log(
          "Description:",
          document.getElementById("description").value
        );
      });
    </script>
  </body>
</html>
